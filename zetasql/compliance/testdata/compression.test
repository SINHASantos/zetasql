[default required_features=NAMED_ARGUMENTS]

[name=zstd_compress_string_with_level_too_low]
select zstd_compress("text", -6);
--

ERROR: generic::out_of_range: ZSTD compression level must be between -5 and 22, but was -6
==

[name=zstd_compress_string_with_level_too_high]
select zstd_compress("text", 23);
--

ERROR: generic::out_of_range: ZSTD compression level must be between -5 and 22, but was 23
==

[name=zstd_decompress_with_invalid_size_limit]
select zstd_decompress_to_string(b"(\xb5/\xfd \x05)\x00\x00bytes", size_limit => 0);
--

ERROR: generic::out_of_range: ZSTD size limit must be positive, but was 0
==

[name=zstd_compress_null]
select zstd_compress(null);
--

ARRAY<STRUCT<BYTES>>[{NULL}]
==

[name=zstd_decompress_to_bytes_null]
select zstd_decompress_to_bytes(null);
--

ARRAY<STRUCT<BYTES>>[{NULL}]
==

[name=zstd_decompress_to_string_null]
select zstd_decompress_to_string(null);
--

ARRAY<STRUCT<STRING>>[{NULL}]
