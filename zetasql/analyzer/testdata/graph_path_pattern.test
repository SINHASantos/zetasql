[default language_features=NONE,+SQL_GRAPH]
[default no_test_extract_table_names]
[default show_sqlbuilder_output]

select * from graph_table(
  aml
  match (a) -[b IS PersonOwnAccount]-> (c)
  columns (a.Id, b.PersonId, c.Id as c_id)
)

--
QueryStmt
+-output_column_list=
| +-$graph_table.Id#4 AS Id [INT64]
| +-$graph_table.PersonId#5 AS PersonId [INT64]
| +-$graph_table.c_id#6 AS c_id [INT64]
+-query=
  +-ProjectScan
    +-column_list=$graph_table.[Id#4, PersonId#5, c_id#6]
    +-input_scan=
      +-GraphTableScan
        +-column_list=$graph_table.[Id#4, PersonId#5, c_id#6]
        +-property_graph=aml
        +-input_scan=
        | +-GraphScan
        |   +-column_list=$element_table.[a#1, b#2, c#3]
        |   +-input_scan_list=
        |     +-GraphPathScan
        |       +-column_list=$element_table.[a#1, b#2, c#3]
        |       +-input_scan_list=
        |       | +-GraphNodeScan
        |       | | +-column_list=[$element_table.a#1]
        |       | | +-label_expr=
        |       | | | +-GraphLabelNaryExpr
        |       | | |   +-op=OR
        |       | | |   +-operand_list=
        |       | | |     +-GraphWildCardLabel
        |       | | |     +-GraphLabelNaryExpr
        |       | | |       +-op=NOT
        |       | | |       +-operand_list=
        |       | | |         +-GraphWildCardLabel
        |       | | +-target_element_table_list=[aml.Account,aml.Person,aml.Syndicate]
        |       | +-GraphEdgeScan
        |       | | +-column_list=[$element_table.b#2]
        |       | | +-label_expr=
        |       | | | +-GraphLabel(parse_location=52-68, label=aml.PersonOwnAccount)
        |       | | +-target_element_table_list=[aml.PersonOwnAccount]
        |       | | +-orientation=RIGHT
        |       | +-GraphNodeScan
        |       |   +-column_list=[$element_table.c#3]
        |       |   +-label_expr=
        |       |   | +-GraphLabelNaryExpr
        |       |   |   +-op=OR
        |       |   |   +-operand_list=
        |       |   |     +-GraphWildCardLabel
        |       |   |     +-GraphLabelNaryExpr
        |       |   |       +-op=NOT
        |       |   |       +-operand_list=
        |       |   |         +-GraphWildCardLabel
        |       |   +-target_element_table_list=[aml.Account,aml.Person,aml.Syndicate]
        |       +-head=$element_table.a#1
        |       +-tail=$element_table.c#3
        +-shape_expr_list=
          +-Id#4 :=
          | +-GraphGetElementProperty
          |   +-type=INT64
          |   +-expr=
          |   | +-ColumnRef(type=GRAPH_NODE(aml)<age UINT32, balance UINT64, birthday DATE, data BYTES, id INT64, name STRING, syndicateData ARRAY<INT64>, syndicateId INT64, syndicateName STRING>, column=$element_table.a#1)
          |   +-property=id(INT64)
          +-PersonId#5 :=
          | +-GraphGetElementProperty
          |   +-type=INT64
          |   +-expr=
          |   | +-ColumnRef(type=GRAPH_EDGE(aml)<accountId INT64, personId INT64>, column=$element_table.b#2)
          |   +-property=personId(INT64)
          +-c_id#6 :=
            +-GraphGetElementProperty
              +-type=INT64
              +-expr=
              | +-ColumnRef(type=GRAPH_NODE(aml)<age UINT32, balance UINT64, birthday DATE, data BYTES, id INT64, name STRING, syndicateData ARRAY<INT64>, syndicateId INT64, syndicateName STRING>, column=$element_table.c#3)
              +-property=id(INT64)

[SQLBUILDER_TARGET_SYNTAX_MODE standard]
[SQLBUILDER_OUTPUT]
SELECT
  aml_1.a_5 AS Id,
  aml_1.a_6 AS PersonId,
  aml_1.a_7 AS c_id
FROM
  GRAPH_TABLE(
    aml
    MATCH
      (a_2
      IS (% | ! %))
      -[a_3
      IS PersonOwnAccount]->
      (a_4
      IS (% | ! %))
    COLUMNS(
      a_2.id AS a_5,
      a_3.personId AS a_6,
      a_4.id AS a_7
    )
  ) AS aml_1;

[SQLBUILDER_TARGET_SYNTAX_MODE pipe]
[SQLBUILDER_OUTPUT]
FROM
  GRAPH_TABLE(
    aml
    MATCH
      (a_2
      IS (% | ! %))
      -[a_3
      IS PersonOwnAccount]->
      (a_4
      IS (% | ! %))
    COLUMNS(
      a_2.id AS a_5,
      a_3.personId AS a_6,
      a_4.id AS a_7
    )
  ) AS aml_1
|> SELECT
     aml_1.a_5 AS Id,
     aml_1.a_6 AS PersonId,
     aml_1.a_7 AS c_id;
==

select * from graph_table(
  aml
match (a IS Account) -[b]-> (a WHERE a.name = "")
  columns (1 as one)
)

--
ERROR: Property name is not exposed by element type GRAPH_NODE(aml)<balance UINT64, id INT64> [at 3:40]
match (a IS Account) -[b]-> (a WHERE a.name = "")
                                       ^
==

select * from graph_table(
  aml
  match (a IS Account) -[b]-> (a)
  columns (1 as one, CAST(a.id as string) AS id_string)
)

--
QueryStmt
+-output_column_list=
| +-$graph_table.one#4 AS one [INT64]
| +-$graph_table.id_string#5 AS id_string [STRING]
+-query=
  +-ProjectScan
    +-column_list=$graph_table.[one#4, id_string#5]
    +-input_scan=
      +-GraphTableScan
        +-column_list=$graph_table.[one#4, id_string#5]
        +-property_graph=aml
        +-input_scan=
        | +-GraphScan
        |   +-column_list=$element_table.[a#1, b#2, a#3]
        |   +-input_scan_list=
        |     +-GraphPathScan
        |       +-column_list=$element_table.[a#1, b#2, a#3]
        |       +-input_scan_list=
        |       | +-GraphNodeScan
        |       | | +-column_list=[$element_table.a#1]
        |       | | +-label_expr=
        |       | | | +-GraphLabelNaryExpr
        |       | | |   +-op=AND
        |       | | |   +-operand_list=
        |       | | |     +-GraphLabel(parse_location=47-54, label=aml.Account)
        |       | | |     +-GraphLabelNaryExpr
        |       | | |       +-op=OR
        |       | | |       +-operand_list=
        |       | | |         +-GraphWildCardLabel
        |       | | |         +-GraphLabelNaryExpr
        |       | | |           +-op=NOT
        |       | | |           +-operand_list=
        |       | | |             +-GraphWildCardLabel
        |       | | +-target_element_table_list=[aml.Account]
        |       | +-GraphEdgeScan
        |       | | +-column_list=[$element_table.b#2]
        |       | | +-label_expr=
        |       | | | +-GraphLabelNaryExpr
        |       | | |   +-op=OR
        |       | | |   +-operand_list=
        |       | | |     +-GraphWildCardLabel
        |       | | |     +-GraphLabelNaryExpr
        |       | | |       +-op=NOT
        |       | | |       +-operand_list=
        |       | | |         +-GraphWildCardLabel
        |       | | +-target_element_table_list=[aml.PersonOwnAccount,aml.Transfer]
        |       | | +-orientation=RIGHT
        |       | +-GraphNodeScan
        |       |   +-column_list=[$element_table.a#3]
        |       |   +-label_expr=
        |       |   | +-GraphLabelNaryExpr
        |       |   |   +-op=AND
        |       |   |   +-operand_list=
        |       |   |     +-GraphLabel(parse_location=47-54, label=aml.Account)
        |       |   |     +-GraphLabelNaryExpr
        |       |   |       +-op=OR
        |       |   |       +-operand_list=
        |       |   |         +-GraphWildCardLabel
        |       |   |         +-GraphLabelNaryExpr
        |       |   |           +-op=NOT
        |       |   |           +-operand_list=
        |       |   |             +-GraphWildCardLabel
        |       |   +-target_element_table_list=[aml.Account]
        |       +-filter_expr=
        |       | +-FunctionCall(ZetaSQL:$equal(GRAPH_NODE(aml)<balance UINT64, id INT64>, GRAPH_NODE(aml)<balance UINT64, id INT64>) -> BOOL)
        |       |   +-ColumnRef(type=GRAPH_NODE(aml)<balance UINT64, id INT64>, column=$element_table.a#1)
        |       |   +-ColumnRef(type=GRAPH_NODE(aml)<balance UINT64, id INT64>, column=$element_table.a#3)
        |       +-head=$element_table.a#1
        |       +-tail=$element_table.a#3
        +-shape_expr_list=
          +-one#4 := Literal(type=INT64, value=1)
          +-id_string#5 :=
            +-Cast(INT64 -> STRING)
              +-GraphGetElementProperty
                +-type=INT64
                +-expr=
                | +-ColumnRef(type=GRAPH_NODE(aml)<balance UINT64, id INT64>, column=$element_table.a#1)
                +-property=id(INT64)

[SQLBUILDER_TARGET_SYNTAX_MODE standard]
[SQLBUILDER_OUTPUT]
SELECT
  aml_1.a_5 AS one,
  aml_1.a_6 AS id_string
FROM
  GRAPH_TABLE(
    aml
    MATCH
      (
        (a_2
        IS (Account &(% | ! %)))
        -[a_3
        IS (% | ! %)]->
        (a_4
        IS (Account &(% | ! %)))
        WHERE
          a_2 = a_4
      )
    COLUMNS(
      1 AS a_5,
      CAST(a_2.id AS STRING) AS a_6
    )
  ) AS aml_1;

[SQLBUILDER_TARGET_SYNTAX_MODE pipe]
[SQLBUILDER_OUTPUT]
FROM
  GRAPH_TABLE(
    aml
    MATCH
      (
        (a_2
        IS (Account &(% | ! %)))
        -[a_3
        IS (% | ! %)]->
        (a_4
        IS (Account &(% | ! %)))
        WHERE
          a_2 = a_4
      )
    COLUMNS(
      1 AS a_5,
      CAST(a_2.id AS STRING) AS a_6
    )
  ) AS aml_1
|> SELECT
     aml_1.a_5 AS one,
     aml_1.a_6 AS id_string;

==

# Multiply-declared variable label resolution: all ocurrences of `a` have
# the same label expression `Person & Account & (% | %)`.
select * from graph_table(
  aml
  match (a IS Person) -> (a IS Account) -> (a)
  columns (1 AS one)
)
--
QueryStmt
+-output_column_list=
| +-$graph_table.one#6 AS one [INT64]
+-query=
  +-ProjectScan
    +-column_list=[$graph_table.one#6]
    +-input_scan=
      +-GraphTableScan
        +-column_list=[$graph_table.one#6]
        +-property_graph=aml
        +-input_scan=
        | +-GraphScan
        |   +-column_list=$element_table.[a#1, $element1#2, a#3, $element2#4, a#5]
        |   +-input_scan_list=
        |     +-GraphPathScan
        |       +-column_list=$element_table.[a#1, $element1#2, a#3, $element2#4, a#5]
        |       +-input_scan_list=
        |       | +-GraphNodeScan
        |       | | +-column_list=[$element_table.a#1]
        |       | | +-label_expr=
        |       | | | +-GraphLabelNaryExpr
        |       | | |   +-op=AND
        |       | | |   +-operand_list=
        |       | | |     +-GraphLabel(parse_location=47-53, label=aml.Person)
        |       | | |     +-GraphLabel(parse_location=64-71, label=aml.Account)
        |       | | |     +-GraphLabelNaryExpr
        |       | | |       +-op=OR
        |       | | |       +-operand_list=
        |       | | |         +-GraphWildCardLabel
        |       | | |         +-GraphLabelNaryExpr
        |       | | |           +-op=NOT
        |       | | |           +-operand_list=
        |       | | |             +-GraphWildCardLabel
        |       | | +-target_element_table_list=[]
        |       | +-GraphEdgeScan
        |       | | +-column_list=[$element_table.$element1#2]
        |       | | +-label_expr=
        |       | | | +-GraphLabelNaryExpr
        |       | | |   +-op=OR
        |       | | |   +-operand_list=
        |       | | |     +-GraphWildCardLabel
        |       | | |     +-GraphLabelNaryExpr
        |       | | |       +-op=NOT
        |       | | |       +-operand_list=
        |       | | |         +-GraphWildCardLabel
        |       | | +-target_element_table_list=[aml.PersonOwnAccount,aml.Transfer]
        |       | | +-orientation=RIGHT
        |       | +-GraphNodeScan
        |       | | +-column_list=[$element_table.a#3]
        |       | | +-label_expr=
        |       | | | +-GraphLabelNaryExpr
        |       | | |   +-op=AND
        |       | | |   +-operand_list=
        |       | | |     +-GraphLabel(parse_location=47-53, label=aml.Person)
        |       | | |     +-GraphLabel(parse_location=64-71, label=aml.Account)
        |       | | |     +-GraphLabelNaryExpr
        |       | | |       +-op=OR
        |       | | |       +-operand_list=
        |       | | |         +-GraphWildCardLabel
        |       | | |         +-GraphLabelNaryExpr
        |       | | |           +-op=NOT
        |       | | |           +-operand_list=
        |       | | |             +-GraphWildCardLabel
        |       | | +-target_element_table_list=[]
        |       | +-GraphEdgeScan
        |       | | +-column_list=[$element_table.$element2#4]
        |       | | +-label_expr=
        |       | | | +-GraphLabelNaryExpr
        |       | | |   +-op=OR
        |       | | |   +-operand_list=
        |       | | |     +-GraphWildCardLabel
        |       | | |     +-GraphLabelNaryExpr
        |       | | |       +-op=NOT
        |       | | |       +-operand_list=
        |       | | |         +-GraphWildCardLabel
        |       | | +-target_element_table_list=[aml.PersonOwnAccount,aml.Transfer]
        |       | | +-orientation=RIGHT
        |       | +-GraphNodeScan
        |       |   +-column_list=[$element_table.a#5]
        |       |   +-label_expr=
        |       |   | +-GraphLabelNaryExpr
        |       |   |   +-op=AND
        |       |   |   +-operand_list=
        |       |   |     +-GraphLabel(parse_location=47-53, label=aml.Person)
        |       |   |     +-GraphLabel(parse_location=64-71, label=aml.Account)
        |       |   |     +-GraphLabelNaryExpr
        |       |   |       +-op=OR
        |       |   |       +-operand_list=
        |       |   |         +-GraphWildCardLabel
        |       |   |         +-GraphLabelNaryExpr
        |       |   |           +-op=NOT
        |       |   |           +-operand_list=
        |       |   |             +-GraphWildCardLabel
        |       |   +-target_element_table_list=[]
        |       +-filter_expr=
        |       | +-FunctionCall(ZetaSQL:$and(BOOL, repeated(1) BOOL) -> BOOL)
        |       |   +-FunctionCall(ZetaSQL:$equal(GRAPH_NODE(aml)<>, GRAPH_NODE(aml)<>) -> BOOL)
        |       |   | +-ColumnRef(type=GRAPH_NODE(aml)<>, column=$element_table.a#1)
        |       |   | +-ColumnRef(type=GRAPH_NODE(aml)<>, column=$element_table.a#3)
        |       |   +-FunctionCall(ZetaSQL:$equal(GRAPH_NODE(aml)<>, GRAPH_NODE(aml)<>) -> BOOL)
        |       |     +-ColumnRef(type=GRAPH_NODE(aml)<>, column=$element_table.a#1)
        |       |     +-ColumnRef(type=GRAPH_NODE(aml)<>, column=$element_table.a#5)
        |       +-head=$element_table.a#1
        |       +-tail=$element_table.a#5
        +-shape_expr_list=
          +-one#6 := Literal(type=INT64, value=1)

[SQLBUILDER_TARGET_SYNTAX_MODE standard]
[SQLBUILDER_OUTPUT]
SELECT
  aml_1.a_7 AS one
FROM
  GRAPH_TABLE(
    aml
    MATCH
      (
        (a_2
        IS (Person & Account &(% | ! %)))
        -[a_3
        IS (% | ! %)]->
        (a_4
        IS (Person & Account &(% | ! %)))
        -[a_5
        IS (% | ! %)]->
        (a_6
        IS (Person & Account &(% | ! %)))
        WHERE
          (a_2 = a_4) AND (a_2 = a_6)
      )
    COLUMNS(
      1 AS a_7
    )
  ) AS aml_1;

[SQLBUILDER_TARGET_SYNTAX_MODE pipe]
[SQLBUILDER_OUTPUT]
FROM
  GRAPH_TABLE(
    aml
    MATCH
      (
        (a_2
        IS (Person & Account &(% | ! %)))
        -[a_3
        IS (% | ! %)]->
        (a_4
        IS (Person & Account &(% | ! %)))
        -[a_5
        IS (% | ! %)]->
        (a_6
        IS (Person & Account &(% | ! %)))
        WHERE
          (a_2 = a_4) AND (a_2 = a_6)
      )
    COLUMNS(
      1 AS a_7
    )
  ) AS aml_1
|> SELECT
     aml_1.a_7 AS one;
==

# After pattern canonicalization, an empty node pattern will be inserted before
# -[a]->.
select * from graph_table(
  aml
  match -[a IS PersonOwnAccount]-> (b IS Account)
  columns (1 as one)
)

--
QueryStmt
+-output_column_list=
| +-$graph_table.one#4 AS one [INT64]
+-query=
  +-ProjectScan
    +-column_list=[$graph_table.one#4]
    +-input_scan=
      +-GraphTableScan
        +-column_list=[$graph_table.one#4]
        +-property_graph=aml
        +-input_scan=
        | +-GraphScan
        |   +-column_list=$element_table.[$element1#1, a#2, b#3]
        |   +-input_scan_list=
        |     +-GraphPathScan
        |       +-column_list=$element_table.[$element1#1, a#2, b#3]
        |       +-input_scan_list=
        |       | +-GraphNodeScan
        |       | | +-column_list=[$element_table.$element1#1]
        |       | | +-label_expr=
        |       | | | +-GraphLabelNaryExpr
        |       | | |   +-op=OR
        |       | | |   +-operand_list=
        |       | | |     +-GraphWildCardLabel
        |       | | |     +-GraphLabelNaryExpr
        |       | | |       +-op=NOT
        |       | | |       +-operand_list=
        |       | | |         +-GraphWildCardLabel
        |       | | +-target_element_table_list=[aml.Account,aml.Person,aml.Syndicate]
        |       | +-GraphEdgeScan
        |       | | +-column_list=[$element_table.a#2]
        |       | | +-label_expr=
        |       | | | +-GraphLabel(parse_location=48-64, label=aml.PersonOwnAccount)
        |       | | +-target_element_table_list=[aml.PersonOwnAccount]
        |       | | +-orientation=RIGHT
        |       | +-GraphNodeScan
        |       |   +-column_list=[$element_table.b#3]
        |       |   +-label_expr=
        |       |   | +-GraphLabel(parse_location=74-81, label=aml.Account)
        |       |   +-target_element_table_list=[aml.Account]
        |       +-head=$element_table.$element1#1
        |       +-tail=$element_table.b#3
        +-shape_expr_list=
          +-one#4 := Literal(type=INT64, value=1)

[SQLBUILDER_TARGET_SYNTAX_MODE standard]
[SQLBUILDER_OUTPUT]
SELECT
  aml_1.a_5 AS one
FROM
  GRAPH_TABLE(
    aml
    MATCH
      (a_2
      IS (% | ! %))
      -[a_3
      IS PersonOwnAccount]->
      (a_4
      IS Account)
    COLUMNS(
      1 AS a_5
    )
  ) AS aml_1;

[SQLBUILDER_TARGET_SYNTAX_MODE pipe]
[SQLBUILDER_OUTPUT]
FROM
  GRAPH_TABLE(
    aml
    MATCH
      (a_2
      IS (% | ! %))
      -[a_3
      IS PersonOwnAccount]->
      (a_4
      IS Account)
    COLUMNS(
      1 AS a_5
    )
  ) AS aml_1
|> SELECT
     aml_1.a_5 AS one;
==

# After pattern canonicalization, an empty node pattern will be inserted after
# -[b]->.
select * from graph_table(
  aml
  match (a IS Person) -[b IS PersonOwnAccount]->
  columns (1 as one)
)

--
QueryStmt
+-output_column_list=
| +-$graph_table.one#4 AS one [INT64]
+-query=
  +-ProjectScan
    +-column_list=[$graph_table.one#4]
    +-input_scan=
      +-GraphTableScan
        +-column_list=[$graph_table.one#4]
        +-property_graph=aml
        +-input_scan=
        | +-GraphScan
        |   +-column_list=$element_table.[a#1, b#2, $element1#3]
        |   +-input_scan_list=
        |     +-GraphPathScan
        |       +-column_list=$element_table.[a#1, b#2, $element1#3]
        |       +-input_scan_list=
        |       | +-GraphNodeScan
        |       | | +-column_list=[$element_table.a#1]
        |       | | +-label_expr=
        |       | | | +-GraphLabel(parse_location=47-53, label=aml.Person)
        |       | | +-target_element_table_list=[aml.Person]
        |       | +-GraphEdgeScan
        |       | | +-column_list=[$element_table.b#2]
        |       | | +-label_expr=
        |       | | | +-GraphLabel(parse_location=62-78, label=aml.PersonOwnAccount)
        |       | | +-target_element_table_list=[aml.PersonOwnAccount]
        |       | | +-orientation=RIGHT
        |       | +-GraphNodeScan
        |       |   +-column_list=[$element_table.$element1#3]
        |       |   +-label_expr=
        |       |   | +-GraphLabelNaryExpr
        |       |   |   +-op=OR
        |       |   |   +-operand_list=
        |       |   |     +-GraphWildCardLabel
        |       |   |     +-GraphLabelNaryExpr
        |       |   |       +-op=NOT
        |       |   |       +-operand_list=
        |       |   |         +-GraphWildCardLabel
        |       |   +-target_element_table_list=[aml.Account,aml.Person,aml.Syndicate]
        |       +-head=$element_table.a#1
        |       +-tail=$element_table.$element1#3
        +-shape_expr_list=
          +-one#4 := Literal(type=INT64, value=1)

[SQLBUILDER_TARGET_SYNTAX_MODE standard]
[SQLBUILDER_OUTPUT]
SELECT
  aml_1.a_5 AS one
FROM
  GRAPH_TABLE(
    aml
    MATCH
      (a_2
      IS Person)
      -[a_3
      IS PersonOwnAccount]->
      (a_4
      IS (% | ! %))
    COLUMNS(
      1 AS a_5
    )
  ) AS aml_1;

[SQLBUILDER_TARGET_SYNTAX_MODE pipe]
[SQLBUILDER_OUTPUT]
FROM
  GRAPH_TABLE(
    aml
    MATCH
      (a_2
      IS Person)
      -[a_3
      IS PersonOwnAccount]->
      (a_4
      IS (% | ! %))
    COLUMNS(
      1 AS a_5
    )
  ) AS aml_1
|> SELECT
     aml_1.a_5 AS one;
==

select * from graph_table(
  aml
  match (a) (b)
  columns (1 as one)
)

--
QueryStmt
+-output_column_list=
| +-$graph_table.one#3 AS one [INT64]
+-query=
  +-ProjectScan
    +-column_list=[$graph_table.one#3]
    +-input_scan=
      +-GraphTableScan
        +-column_list=[$graph_table.one#3]
        +-property_graph=aml
        +-input_scan=
        | +-GraphScan
        |   +-column_list=$element_table.[a#1, b#2]
        |   +-input_scan_list=
        |     +-GraphPathScan
        |       +-column_list=$element_table.[a#1, b#2]
        |       +-input_scan_list=
        |       | +-GraphNodeScan
        |       | | +-column_list=[$element_table.a#1]
        |       | | +-label_expr=
        |       | | | +-GraphLabelNaryExpr
        |       | | |   +-op=OR
        |       | | |   +-operand_list=
        |       | | |     +-GraphWildCardLabel
        |       | | |     +-GraphLabelNaryExpr
        |       | | |       +-op=NOT
        |       | | |       +-operand_list=
        |       | | |         +-GraphWildCardLabel
        |       | | +-target_element_table_list=[aml.Account,aml.Person,aml.Syndicate]
        |       | +-GraphNodeScan
        |       |   +-column_list=[$element_table.b#2]
        |       |   +-label_expr=
        |       |   | +-GraphLabelNaryExpr
        |       |   |   +-op=OR
        |       |   |   +-operand_list=
        |       |   |     +-GraphWildCardLabel
        |       |   |     +-GraphLabelNaryExpr
        |       |   |       +-op=NOT
        |       |   |       +-operand_list=
        |       |   |         +-GraphWildCardLabel
        |       |   +-target_element_table_list=[aml.Account,aml.Person,aml.Syndicate]
        |       +-head=$element_table.a#1
        |       +-tail=$element_table.b#2
        +-shape_expr_list=
          +-one#3 := Literal(type=INT64, value=1)

[SQLBUILDER_TARGET_SYNTAX_MODE standard]
[SQLBUILDER_OUTPUT]
SELECT
  aml_1.a_4 AS one
FROM
  GRAPH_TABLE(
    aml
    MATCH
      (a_2
      IS (% | ! %))
      (a_3
      IS (% | ! %))
    COLUMNS(
      1 AS a_4
    )
  ) AS aml_1;

[SQLBUILDER_TARGET_SYNTAX_MODE pipe]
[SQLBUILDER_OUTPUT]
FROM
  GRAPH_TABLE(
    aml
    MATCH
      (a_2
      IS (% | ! %))
      (a_3
      IS (% | ! %))
    COLUMNS(
      1 AS a_4
    )
  ) AS aml_1
|> SELECT
     aml_1.a_4 AS one;
==

select * from graph_table(
  aml
  match -[a IS Transfer]-> <-[b IS Transfer]-
  columns (1 as one)
)
--
QueryStmt
+-output_column_list=
| +-$graph_table.one#6 AS one [INT64]
+-query=
  +-ProjectScan
    +-column_list=[$graph_table.one#6]
    +-input_scan=
      +-GraphTableScan
        +-column_list=[$graph_table.one#6]
        +-property_graph=aml
        +-input_scan=
        | +-GraphScan
        |   +-column_list=$element_table.[$element1#1, a#2, $element2#3, b#4, $element3#5]
        |   +-input_scan_list=
        |     +-GraphPathScan
        |       +-column_list=$element_table.[$element1#1, a#2, $element2#3, b#4, $element3#5]
        |       +-input_scan_list=
        |       | +-GraphNodeScan
        |       | | +-column_list=[$element_table.$element1#1]
        |       | | +-label_expr=
        |       | | | +-GraphLabelNaryExpr
        |       | | |   +-op=OR
        |       | | |   +-operand_list=
        |       | | |     +-GraphWildCardLabel
        |       | | |     +-GraphLabelNaryExpr
        |       | | |       +-op=NOT
        |       | | |       +-operand_list=
        |       | | |         +-GraphWildCardLabel
        |       | | +-target_element_table_list=[aml.Account,aml.Person,aml.Syndicate]
        |       | +-GraphEdgeScan
        |       | | +-column_list=[$element_table.a#2]
        |       | | +-label_expr=
        |       | | | +-GraphLabel(parse_location=48-56, label=aml.Transfer)
        |       | | +-target_element_table_list=[aml.Transfer]
        |       | | +-orientation=RIGHT
        |       | +-GraphNodeScan
        |       | | +-column_list=[$element_table.$element2#3]
        |       | | +-label_expr=
        |       | | | +-GraphLabelNaryExpr
        |       | | |   +-op=OR
        |       | | |   +-operand_list=
        |       | | |     +-GraphWildCardLabel
        |       | | |     +-GraphLabelNaryExpr
        |       | | |       +-op=NOT
        |       | | |       +-operand_list=
        |       | | |         +-GraphWildCardLabel
        |       | | +-target_element_table_list=[aml.Account,aml.Person,aml.Syndicate]
        |       | +-GraphEdgeScan
        |       | | +-column_list=[$element_table.b#4]
        |       | | +-label_expr=
        |       | | | +-GraphLabel(parse_location=68-76, label=aml.Transfer)
        |       | | +-target_element_table_list=[aml.Transfer]
        |       | | +-orientation=LEFT
        |       | +-GraphNodeScan
        |       |   +-column_list=[$element_table.$element3#5]
        |       |   +-label_expr=
        |       |   | +-GraphLabelNaryExpr
        |       |   |   +-op=OR
        |       |   |   +-operand_list=
        |       |   |     +-GraphWildCardLabel
        |       |   |     +-GraphLabelNaryExpr
        |       |   |       +-op=NOT
        |       |   |       +-operand_list=
        |       |   |         +-GraphWildCardLabel
        |       |   +-target_element_table_list=[aml.Account,aml.Person,aml.Syndicate]
        |       +-head=$element_table.$element1#1
        |       +-tail=$element_table.$element3#5
        +-shape_expr_list=
          +-one#6 := Literal(type=INT64, value=1)

[SQLBUILDER_TARGET_SYNTAX_MODE standard]
[SQLBUILDER_OUTPUT]
SELECT
  aml_1.a_7 AS one
FROM
  GRAPH_TABLE(
    aml
    MATCH
      (a_2
      IS (% | ! %))
      -[a_3
      IS Transfer]->
      (a_4
      IS (% | ! %))
      <-[a_5
      IS Transfer]-
      (a_6
      IS (% | ! %))
    COLUMNS(
      1 AS a_7
    )
  ) AS aml_1;

[SQLBUILDER_TARGET_SYNTAX_MODE pipe]
[SQLBUILDER_OUTPUT]
FROM
  GRAPH_TABLE(
    aml
    MATCH
      (a_2
      IS (% | ! %))
      -[a_3
      IS Transfer]->
      (a_4
      IS (% | ! %))
      <-[a_5
      IS Transfer]-
      (a_6
      IS (% | ! %))
    COLUMNS(
      1 AS a_7
    )
  ) AS aml_1
|> SELECT
     aml_1.a_7 AS one;
==

select * from graph_table(
  aml
  match -[IS Transfer]-> -[IS Transfer]->
  columns (1 as one)
)

--
QueryStmt
+-output_column_list=
| +-$graph_table.one#6 AS one [INT64]
+-query=
  +-ProjectScan
    +-column_list=[$graph_table.one#6]
    +-input_scan=
      +-GraphTableScan
        +-column_list=[$graph_table.one#6]
        +-property_graph=aml
        +-input_scan=
        | +-GraphScan
        |   +-column_list=$element_table.[$element1#1, $element2#2, $element3#3, $element4#4, $element5#5]
        |   +-input_scan_list=
        |     +-GraphPathScan
        |       +-column_list=$element_table.[$element1#1, $element2#2, $element3#3, $element4#4, $element5#5]
        |       +-input_scan_list=
        |       | +-GraphNodeScan
        |       | | +-column_list=[$element_table.$element1#1]
        |       | | +-label_expr=
        |       | | | +-GraphLabelNaryExpr
        |       | | |   +-op=OR
        |       | | |   +-operand_list=
        |       | | |     +-GraphWildCardLabel
        |       | | |     +-GraphLabelNaryExpr
        |       | | |       +-op=NOT
        |       | | |       +-operand_list=
        |       | | |         +-GraphWildCardLabel
        |       | | +-target_element_table_list=[aml.Account,aml.Person,aml.Syndicate]
        |       | +-GraphEdgeScan
        |       | | +-column_list=[$element_table.$element2#2]
        |       | | +-label_expr=
        |       | | | +-GraphLabel(parse_location=46-54, label=aml.Transfer)
        |       | | +-target_element_table_list=[aml.Transfer]
        |       | | +-orientation=RIGHT
        |       | +-GraphNodeScan
        |       | | +-column_list=[$element_table.$element3#3]
        |       | | +-label_expr=
        |       | | | +-GraphLabelNaryExpr
        |       | | |   +-op=OR
        |       | | |   +-operand_list=
        |       | | |     +-GraphWildCardLabel
        |       | | |     +-GraphLabelNaryExpr
        |       | | |       +-op=NOT
        |       | | |       +-operand_list=
        |       | | |         +-GraphWildCardLabel
        |       | | +-target_element_table_list=[aml.Account,aml.Person,aml.Syndicate]
        |       | +-GraphEdgeScan
        |       | | +-column_list=[$element_table.$element4#4]
        |       | | +-label_expr=
        |       | | | +-GraphLabel(parse_location=63-71, label=aml.Transfer)
        |       | | +-target_element_table_list=[aml.Transfer]
        |       | | +-orientation=RIGHT
        |       | +-GraphNodeScan
        |       |   +-column_list=[$element_table.$element5#5]
        |       |   +-label_expr=
        |       |   | +-GraphLabelNaryExpr
        |       |   |   +-op=OR
        |       |   |   +-operand_list=
        |       |   |     +-GraphWildCardLabel
        |       |   |     +-GraphLabelNaryExpr
        |       |   |       +-op=NOT
        |       |   |       +-operand_list=
        |       |   |         +-GraphWildCardLabel
        |       |   +-target_element_table_list=[aml.Account,aml.Person,aml.Syndicate]
        |       +-head=$element_table.$element1#1
        |       +-tail=$element_table.$element5#5
        +-shape_expr_list=
          +-one#6 := Literal(type=INT64, value=1)

[SQLBUILDER_TARGET_SYNTAX_MODE standard]
[SQLBUILDER_OUTPUT]
SELECT
  aml_1.a_7 AS one
FROM
  GRAPH_TABLE(
    aml
    MATCH
      (a_2
      IS (% | ! %))
      -[a_3
      IS Transfer]->
      (a_4
      IS (% | ! %))
      -[a_5
      IS Transfer]->
      (a_6
      IS (% | ! %))
    COLUMNS(
      1 AS a_7
    )
  ) AS aml_1;

[SQLBUILDER_TARGET_SYNTAX_MODE pipe]
[SQLBUILDER_OUTPUT]
FROM
  GRAPH_TABLE(
    aml
    MATCH
      (a_2
      IS (% | ! %))
      -[a_3
      IS Transfer]->
      (a_4
      IS (% | ! %))
      -[a_5
      IS Transfer]->
      (a_6
      IS (% | ! %))
    COLUMNS(
      1 AS a_7
    )
  ) AS aml_1
|> SELECT
     aml_1.a_7 AS one;
==

select * from graph_table(
  aml
  match -[IS Transfer]- -[IS Transfer]-
  columns (1 as one)
)

--
QueryStmt
+-output_column_list=
| +-$graph_table.one#6 AS one [INT64]
+-query=
  +-ProjectScan
    +-column_list=[$graph_table.one#6]
    +-input_scan=
      +-GraphTableScan
        +-column_list=[$graph_table.one#6]
        +-property_graph=aml
        +-input_scan=
        | +-GraphScan
        |   +-column_list=$element_table.[$element1#1, $element2#2, $element3#3, $element4#4, $element5#5]
        |   +-input_scan_list=
        |     +-GraphPathScan
        |       +-column_list=$element_table.[$element1#1, $element2#2, $element3#3, $element4#4, $element5#5]
        |       +-input_scan_list=
        |       | +-GraphNodeScan
        |       | | +-column_list=[$element_table.$element1#1]
        |       | | +-label_expr=
        |       | | | +-GraphLabelNaryExpr
        |       | | |   +-op=OR
        |       | | |   +-operand_list=
        |       | | |     +-GraphWildCardLabel
        |       | | |     +-GraphLabelNaryExpr
        |       | | |       +-op=NOT
        |       | | |       +-operand_list=
        |       | | |         +-GraphWildCardLabel
        |       | | +-target_element_table_list=[aml.Account,aml.Person,aml.Syndicate]
        |       | +-GraphEdgeScan
        |       | | +-column_list=[$element_table.$element2#2]
        |       | | +-label_expr=
        |       | | | +-GraphLabel(parse_location=46-54, label=aml.Transfer)
        |       | | +-target_element_table_list=[aml.Transfer]
        |       | | +-orientation=ANY
        |       | +-GraphNodeScan
        |       | | +-column_list=[$element_table.$element3#3]
        |       | | +-label_expr=
        |       | | | +-GraphLabelNaryExpr
        |       | | |   +-op=OR
        |       | | |   +-operand_list=
        |       | | |     +-GraphWildCardLabel
        |       | | |     +-GraphLabelNaryExpr
        |       | | |       +-op=NOT
        |       | | |       +-operand_list=
        |       | | |         +-GraphWildCardLabel
        |       | | +-target_element_table_list=[aml.Account,aml.Person,aml.Syndicate]
        |       | +-GraphEdgeScan
        |       | | +-column_list=[$element_table.$element4#4]
        |       | | +-label_expr=
        |       | | | +-GraphLabel(parse_location=62-70, label=aml.Transfer)
        |       | | +-target_element_table_list=[aml.Transfer]
        |       | | +-orientation=ANY
        |       | +-GraphNodeScan
        |       |   +-column_list=[$element_table.$element5#5]
        |       |   +-label_expr=
        |       |   | +-GraphLabelNaryExpr
        |       |   |   +-op=OR
        |       |   |   +-operand_list=
        |       |   |     +-GraphWildCardLabel
        |       |   |     +-GraphLabelNaryExpr
        |       |   |       +-op=NOT
        |       |   |       +-operand_list=
        |       |   |         +-GraphWildCardLabel
        |       |   +-target_element_table_list=[aml.Account,aml.Person,aml.Syndicate]
        |       +-head=$element_table.$element1#1
        |       +-tail=$element_table.$element5#5
        +-shape_expr_list=
          +-one#6 := Literal(type=INT64, value=1)

[SQLBUILDER_TARGET_SYNTAX_MODE standard]
[SQLBUILDER_OUTPUT]
SELECT
  aml_1.a_7 AS one
FROM
  GRAPH_TABLE(
    aml
    MATCH
      (a_2
      IS (% | ! %))
      -[a_3
      IS Transfer]-
      (a_4
      IS (% | ! %))
      -[a_5
      IS Transfer]-
      (a_6
      IS (% | ! %))
    COLUMNS(
      1 AS a_7
    )
  ) AS aml_1;

[SQLBUILDER_TARGET_SYNTAX_MODE pipe]
[SQLBUILDER_OUTPUT]
FROM
  GRAPH_TABLE(
    aml
    MATCH
      (a_2
      IS (% | ! %))
      -[a_3
      IS Transfer]-
      (a_4
      IS (% | ! %))
      -[a_5
      IS Transfer]-
      (a_6
      IS (% | ! %))
    COLUMNS(
      1 AS a_7
    )
  ) AS aml_1
|> SELECT
     aml_1.a_7 AS one;
==

select * from graph_table(
  aml
  match <-[IS Transfer]- <-[IS Transfer]-
  columns (1 as one)
)
--
QueryStmt
+-output_column_list=
| +-$graph_table.one#6 AS one [INT64]
+-query=
  +-ProjectScan
    +-column_list=[$graph_table.one#6]
    +-input_scan=
      +-GraphTableScan
        +-column_list=[$graph_table.one#6]
        +-property_graph=aml
        +-input_scan=
        | +-GraphScan
        |   +-column_list=$element_table.[$element1#1, $element2#2, $element3#3, $element4#4, $element5#5]
        |   +-input_scan_list=
        |     +-GraphPathScan
        |       +-column_list=$element_table.[$element1#1, $element2#2, $element3#3, $element4#4, $element5#5]
        |       +-input_scan_list=
        |       | +-GraphNodeScan
        |       | | +-column_list=[$element_table.$element1#1]
        |       | | +-label_expr=
        |       | | | +-GraphLabelNaryExpr
        |       | | |   +-op=OR
        |       | | |   +-operand_list=
        |       | | |     +-GraphWildCardLabel
        |       | | |     +-GraphLabelNaryExpr
        |       | | |       +-op=NOT
        |       | | |       +-operand_list=
        |       | | |         +-GraphWildCardLabel
        |       | | +-target_element_table_list=[aml.Account,aml.Person,aml.Syndicate]
        |       | +-GraphEdgeScan
        |       | | +-column_list=[$element_table.$element2#2]
        |       | | +-label_expr=
        |       | | | +-GraphLabel(parse_location=47-55, label=aml.Transfer)
        |       | | +-target_element_table_list=[aml.Transfer]
        |       | | +-orientation=LEFT
        |       | +-GraphNodeScan
        |       | | +-column_list=[$element_table.$element3#3]
        |       | | +-label_expr=
        |       | | | +-GraphLabelNaryExpr
        |       | | |   +-op=OR
        |       | | |   +-operand_list=
        |       | | |     +-GraphWildCardLabel
        |       | | |     +-GraphLabelNaryExpr
        |       | | |       +-op=NOT
        |       | | |       +-operand_list=
        |       | | |         +-GraphWildCardLabel
        |       | | +-target_element_table_list=[aml.Account,aml.Person,aml.Syndicate]
        |       | +-GraphEdgeScan
        |       | | +-column_list=[$element_table.$element4#4]
        |       | | +-label_expr=
        |       | | | +-GraphLabel(parse_location=64-72, label=aml.Transfer)
        |       | | +-target_element_table_list=[aml.Transfer]
        |       | | +-orientation=LEFT
        |       | +-GraphNodeScan
        |       |   +-column_list=[$element_table.$element5#5]
        |       |   +-label_expr=
        |       |   | +-GraphLabelNaryExpr
        |       |   |   +-op=OR
        |       |   |   +-operand_list=
        |       |   |     +-GraphWildCardLabel
        |       |   |     +-GraphLabelNaryExpr
        |       |   |       +-op=NOT
        |       |   |       +-operand_list=
        |       |   |         +-GraphWildCardLabel
        |       |   +-target_element_table_list=[aml.Account,aml.Person,aml.Syndicate]
        |       +-head=$element_table.$element1#1
        |       +-tail=$element_table.$element5#5
        +-shape_expr_list=
          +-one#6 := Literal(type=INT64, value=1)

[SQLBUILDER_TARGET_SYNTAX_MODE standard]
[SQLBUILDER_OUTPUT]
SELECT
  aml_1.a_7 AS one
FROM
  GRAPH_TABLE(
    aml
    MATCH
      (a_2
      IS (% | ! %))
      <-[a_3
      IS Transfer]-
      (a_4
      IS (% | ! %))
      <-[a_5
      IS Transfer]-
      (a_6
      IS (% | ! %))
    COLUMNS(
      1 AS a_7
    )
  ) AS aml_1;

[SQLBUILDER_TARGET_SYNTAX_MODE pipe]
[SQLBUILDER_OUTPUT]
FROM
  GRAPH_TABLE(
    aml
    MATCH
      (a_2
      IS (% | ! %))
      <-[a_3
      IS Transfer]-
      (a_4
      IS (% | ! %))
      <-[a_5
      IS Transfer]-
      (a_6
      IS (% | ! %))
    COLUMNS(
      1 AS a_7
    )
  ) AS aml_1
|> SELECT
     aml_1.a_7 AS one;
==

# 3-hop path.
select * from graph_table(
  aml
  match (a IS Person WHERE a.Name = 'Alice') -> (IS Account) -> (IS Account) <- (b IS Person)
  columns (a.Name AS sender, b.Name as receiver)
)
--
QueryStmt
+-output_column_list=
| +-$graph_table.sender#8 AS sender [STRING]
| +-$graph_table.receiver#9 AS receiver [STRING]
+-query=
  +-ProjectScan
    +-column_list=$graph_table.[sender#8, receiver#9]
    +-input_scan=
      +-GraphTableScan
        +-column_list=$graph_table.[sender#8, receiver#9]
        +-property_graph=aml
        +-input_scan=
        | +-GraphScan
        |   +-column_list=$element_table.[a#1, $element1#2, $element2#3, $element3#4, $element4#5, $element5#6, b#7]
        |   +-input_scan_list=
        |     +-GraphPathScan
        |       +-column_list=$element_table.[a#1, $element1#2, $element2#3, $element3#4, $element4#5, $element5#6, b#7]
        |       +-input_scan_list=
        |       | +-GraphNodeScan
        |       | | +-column_list=[$element_table.a#1]
        |       | | +-filter_expr=
        |       | | | +-FunctionCall(ZetaSQL:$equal(STRING, STRING) -> BOOL)
        |       | | |   +-GraphGetElementProperty
        |       | | |   | +-type=STRING
        |       | | |   | +-expr=
        |       | | |   | | +-ColumnRef(type=GRAPH_NODE(aml)<age UINT32, birthday DATE, data BYTES, id INT64, name STRING>, column=$element_table.a#1)
        |       | | |   | +-property=name(STRING)
        |       | | |   +-Literal(type=STRING, value="Alice")
        |       | | +-label_expr=
        |       | | | +-GraphLabel(parse_location=47-53, label=aml.Person)
        |       | | +-target_element_table_list=[aml.Person]
        |       | +-GraphEdgeScan
        |       | | +-column_list=[$element_table.$element1#2]
        |       | | +-label_expr=
        |       | | | +-GraphLabelNaryExpr
        |       | | |   +-op=OR
        |       | | |   +-operand_list=
        |       | | |     +-GraphWildCardLabel
        |       | | |     +-GraphLabelNaryExpr
        |       | | |       +-op=NOT
        |       | | |       +-operand_list=
        |       | | |         +-GraphWildCardLabel
        |       | | +-target_element_table_list=[aml.PersonOwnAccount,aml.Transfer]
        |       | | +-orientation=RIGHT
        |       | +-GraphNodeScan
        |       | | +-column_list=[$element_table.$element2#3]
        |       | | +-label_expr=
        |       | | | +-GraphLabel(parse_location=85-92, label=aml.Account)
        |       | | +-target_element_table_list=[aml.Account]
        |       | +-GraphEdgeScan
        |       | | +-column_list=[$element_table.$element3#4]
        |       | | +-label_expr=
        |       | | | +-GraphLabelNaryExpr
        |       | | |   +-op=OR
        |       | | |   +-operand_list=
        |       | | |     +-GraphWildCardLabel
        |       | | |     +-GraphLabelNaryExpr
        |       | | |       +-op=NOT
        |       | | |       +-operand_list=
        |       | | |         +-GraphWildCardLabel
        |       | | +-target_element_table_list=[aml.PersonOwnAccount,aml.Transfer]
        |       | | +-orientation=RIGHT
        |       | +-GraphNodeScan
        |       | | +-column_list=[$element_table.$element4#5]
        |       | | +-label_expr=
        |       | | | +-GraphLabel(parse_location=101-108, label=aml.Account)
        |       | | +-target_element_table_list=[aml.Account]
        |       | +-GraphEdgeScan
        |       | | +-column_list=[$element_table.$element5#6]
        |       | | +-label_expr=
        |       | | | +-GraphLabelNaryExpr
        |       | | |   +-op=OR
        |       | | |   +-operand_list=
        |       | | |     +-GraphWildCardLabel
        |       | | |     +-GraphLabelNaryExpr
        |       | | |       +-op=NOT
        |       | | |       +-operand_list=
        |       | | |         +-GraphWildCardLabel
        |       | | +-target_element_table_list=[aml.PersonOwnAccount,aml.Transfer]
        |       | | +-orientation=LEFT
        |       | +-GraphNodeScan
        |       |   +-column_list=[$element_table.b#7]
        |       |   +-label_expr=
        |       |   | +-GraphLabel(parse_location=119-125, label=aml.Person)
        |       |   +-target_element_table_list=[aml.Person]
        |       +-head=$element_table.a#1
        |       +-tail=$element_table.b#7
        +-shape_expr_list=
          +-sender#8 :=
          | +-GraphGetElementProperty
          |   +-type=STRING
          |   +-expr=
          |   | +-ColumnRef(type=GRAPH_NODE(aml)<age UINT32, birthday DATE, data BYTES, id INT64, name STRING>, column=$element_table.a#1)
          |   +-property=name(STRING)
          +-receiver#9 :=
            +-GraphGetElementProperty
              +-type=STRING
              +-expr=
              | +-ColumnRef(type=GRAPH_NODE(aml)<age UINT32, birthday DATE, data BYTES, id INT64, name STRING>, column=$element_table.b#7)
              +-property=name(STRING)

[SQLBUILDER_TARGET_SYNTAX_MODE standard]
[SQLBUILDER_OUTPUT]
SELECT
  aml_1.a_9 AS sender,
  aml_1.a_10 AS receiver
FROM
  GRAPH_TABLE(
    aml
    MATCH
      (a_2
      IS Person
      WHERE
        (a_2.name) = "Alice")
      -[a_3
      IS (% | ! %)]->
      (a_4
      IS Account)
      -[a_5
      IS (% | ! %)]->
      (a_6
      IS Account)
      <-[a_7
      IS (% | ! %)]-
      (a_8
      IS Person)
    COLUMNS(
      a_2.name AS a_9,
      a_8.name AS a_10
    )
  ) AS aml_1;

[SQLBUILDER_TARGET_SYNTAX_MODE pipe]
[SQLBUILDER_OUTPUT]
FROM
  GRAPH_TABLE(
    aml
    MATCH
      (a_2
      IS Person
      WHERE
        (a_2.name) = "Alice")
      -[a_3
      IS (% | ! %)]->
      (a_4
      IS Account)
      -[a_5
      IS (% | ! %)]->
      (a_6
      IS Account)
      <-[a_7
      IS (% | ! %)]-
      (a_8
      IS Person)
    COLUMNS(
      a_2.name AS a_9,
      a_8.name AS a_10
    )
  ) AS aml_1
|> SELECT
     aml_1.a_9 AS sender,
     aml_1.a_10 AS receiver;
==

# Matches Person, PersonOwnAccount, Account
# when edge orientation is RIGHT or ANY.
select * from graph_table(
  aml
  match (IS Person) {{<-|-|->}} (IS Account)
  columns (1 as one)
)

--
ALTERNATION GROUP: <-
--
QueryStmt
+-output_column_list=
| +-$graph_table.one#4 AS one [INT64]
+-query=
  +-ProjectScan
    +-column_list=[$graph_table.one#4]
    +-input_scan=
      +-GraphTableScan
        +-column_list=[$graph_table.one#4]
        +-property_graph=aml
        +-input_scan=
        | +-GraphScan
        |   +-column_list=$element_table.[$element1#1, $element2#2, $element3#3]
        |   +-input_scan_list=
        |     +-GraphPathScan
        |       +-column_list=$element_table.[$element1#1, $element2#2, $element3#3]
        |       +-input_scan_list=
        |       | +-GraphNodeScan
        |       | | +-column_list=[$element_table.$element1#1]
        |       | | +-label_expr=
        |       | | | +-GraphLabel(parse_location=45-51, label=aml.Person)
        |       | | +-target_element_table_list=[aml.Person]
        |       | +-GraphEdgeScan
        |       | | +-column_list=[$element_table.$element2#2]
        |       | | +-label_expr=
        |       | | | +-GraphLabelNaryExpr
        |       | | |   +-op=OR
        |       | | |   +-operand_list=
        |       | | |     +-GraphWildCardLabel
        |       | | |     +-GraphLabelNaryExpr
        |       | | |       +-op=NOT
        |       | | |       +-operand_list=
        |       | | |         +-GraphWildCardLabel
        |       | | +-target_element_table_list=[aml.PersonOwnAccount,aml.Transfer]
        |       | | +-orientation=LEFT
        |       | +-GraphNodeScan
        |       |   +-column_list=[$element_table.$element3#3]
        |       |   +-label_expr=
        |       |   | +-GraphLabel(parse_location=60-67, label=aml.Account)
        |       |   +-target_element_table_list=[aml.Account]
        |       +-head=$element_table.$element1#1
        |       +-tail=$element_table.$element3#3
        +-shape_expr_list=
          +-one#4 := Literal(type=INT64, value=1)

[SQLBUILDER_TARGET_SYNTAX_MODE standard]
[SQLBUILDER_OUTPUT]
SELECT
  aml_1.a_5 AS one
FROM
  GRAPH_TABLE(
    aml
    MATCH
      (a_2
      IS Person)
      <-[a_3
      IS (% | ! %)]-
      (a_4
      IS Account)
    COLUMNS(
      1 AS a_5
    )
  ) AS aml_1;

[SQLBUILDER_TARGET_SYNTAX_MODE pipe]
[SQLBUILDER_OUTPUT]
FROM
  GRAPH_TABLE(
    aml
    MATCH
      (a_2
      IS Person)
      <-[a_3
      IS (% | ! %)]-
      (a_4
      IS Account)
    COLUMNS(
      1 AS a_5
    )
  ) AS aml_1
|> SELECT
     aml_1.a_5 AS one;
--
ALTERNATION GROUP: -
--
QueryStmt
+-output_column_list=
| +-$graph_table.one#4 AS one [INT64]
+-query=
  +-ProjectScan
    +-column_list=[$graph_table.one#4]
    +-input_scan=
      +-GraphTableScan
        +-column_list=[$graph_table.one#4]
        +-property_graph=aml
        +-input_scan=
        | +-GraphScan
        |   +-column_list=$element_table.[$element1#1, $element2#2, $element3#3]
        |   +-input_scan_list=
        |     +-GraphPathScan
        |       +-column_list=$element_table.[$element1#1, $element2#2, $element3#3]
        |       +-input_scan_list=
        |       | +-GraphNodeScan
        |       | | +-column_list=[$element_table.$element1#1]
        |       | | +-label_expr=
        |       | | | +-GraphLabel(parse_location=45-51, label=aml.Person)
        |       | | +-target_element_table_list=[aml.Person]
        |       | +-GraphEdgeScan
        |       | | +-column_list=[$element_table.$element2#2]
        |       | | +-label_expr=
        |       | | | +-GraphLabelNaryExpr
        |       | | |   +-op=OR
        |       | | |   +-operand_list=
        |       | | |     +-GraphWildCardLabel
        |       | | |     +-GraphLabelNaryExpr
        |       | | |       +-op=NOT
        |       | | |       +-operand_list=
        |       | | |         +-GraphWildCardLabel
        |       | | +-target_element_table_list=[aml.PersonOwnAccount,aml.Transfer]
        |       | | +-orientation=ANY
        |       | +-GraphNodeScan
        |       |   +-column_list=[$element_table.$element3#3]
        |       |   +-label_expr=
        |       |   | +-GraphLabel(parse_location=59-66, label=aml.Account)
        |       |   +-target_element_table_list=[aml.Account]
        |       +-head=$element_table.$element1#1
        |       +-tail=$element_table.$element3#3
        +-shape_expr_list=
          +-one#4 := Literal(type=INT64, value=1)

[SQLBUILDER_TARGET_SYNTAX_MODE standard]
[SQLBUILDER_OUTPUT]
SELECT
  aml_1.a_5 AS one
FROM
  GRAPH_TABLE(
    aml
    MATCH
      (a_2
      IS Person)
      -[a_3
      IS (% | ! %)]-
      (a_4
      IS Account)
    COLUMNS(
      1 AS a_5
    )
  ) AS aml_1;

[SQLBUILDER_TARGET_SYNTAX_MODE pipe]
[SQLBUILDER_OUTPUT]
FROM
  GRAPH_TABLE(
    aml
    MATCH
      (a_2
      IS Person)
      -[a_3
      IS (% | ! %)]-
      (a_4
      IS Account)
    COLUMNS(
      1 AS a_5
    )
  ) AS aml_1
|> SELECT
     aml_1.a_5 AS one;
--
ALTERNATION GROUP: ->
--
QueryStmt
+-output_column_list=
| +-$graph_table.one#4 AS one [INT64]
+-query=
  +-ProjectScan
    +-column_list=[$graph_table.one#4]
    +-input_scan=
      +-GraphTableScan
        +-column_list=[$graph_table.one#4]
        +-property_graph=aml
        +-input_scan=
        | +-GraphScan
        |   +-column_list=$element_table.[$element1#1, $element2#2, $element3#3]
        |   +-input_scan_list=
        |     +-GraphPathScan
        |       +-column_list=$element_table.[$element1#1, $element2#2, $element3#3]
        |       +-input_scan_list=
        |       | +-GraphNodeScan
        |       | | +-column_list=[$element_table.$element1#1]
        |       | | +-label_expr=
        |       | | | +-GraphLabel(parse_location=45-51, label=aml.Person)
        |       | | +-target_element_table_list=[aml.Person]
        |       | +-GraphEdgeScan
        |       | | +-column_list=[$element_table.$element2#2]
        |       | | +-label_expr=
        |       | | | +-GraphLabelNaryExpr
        |       | | |   +-op=OR
        |       | | |   +-operand_list=
        |       | | |     +-GraphWildCardLabel
        |       | | |     +-GraphLabelNaryExpr
        |       | | |       +-op=NOT
        |       | | |       +-operand_list=
        |       | | |         +-GraphWildCardLabel
        |       | | +-target_element_table_list=[aml.PersonOwnAccount,aml.Transfer]
        |       | | +-orientation=RIGHT
        |       | +-GraphNodeScan
        |       |   +-column_list=[$element_table.$element3#3]
        |       |   +-label_expr=
        |       |   | +-GraphLabel(parse_location=60-67, label=aml.Account)
        |       |   +-target_element_table_list=[aml.Account]
        |       +-head=$element_table.$element1#1
        |       +-tail=$element_table.$element3#3
        +-shape_expr_list=
          +-one#4 := Literal(type=INT64, value=1)

[SQLBUILDER_TARGET_SYNTAX_MODE standard]
[SQLBUILDER_OUTPUT]
SELECT
  aml_1.a_5 AS one
FROM
  GRAPH_TABLE(
    aml
    MATCH
      (a_2
      IS Person)
      -[a_3
      IS (% | ! %)]->
      (a_4
      IS Account)
    COLUMNS(
      1 AS a_5
    )
  ) AS aml_1;

[SQLBUILDER_TARGET_SYNTAX_MODE pipe]
[SQLBUILDER_OUTPUT]
FROM
  GRAPH_TABLE(
    aml
    MATCH
      (a_2
      IS Person)
      -[a_3
      IS (% | ! %)]->
      (a_4
      IS Account)
    COLUMNS(
      1 AS a_5
    )
  ) AS aml_1
|> SELECT
     aml_1.a_5 AS one;
==

# Matches Account, Transfer, Account
# regardless of orientation.
select * from graph_table(
  aml
  match (IS Account) {{<-|-|->}} (IS Account)
  columns (1 as one)
)

--
ALTERNATION GROUP: <-
--
QueryStmt
+-output_column_list=
| +-$graph_table.one#4 AS one [INT64]
+-query=
  +-ProjectScan
    +-column_list=[$graph_table.one#4]
    +-input_scan=
      +-GraphTableScan
        +-column_list=[$graph_table.one#4]
        +-property_graph=aml
        +-input_scan=
        | +-GraphScan
        |   +-column_list=$element_table.[$element1#1, $element2#2, $element3#3]
        |   +-input_scan_list=
        |     +-GraphPathScan
        |       +-column_list=$element_table.[$element1#1, $element2#2, $element3#3]
        |       +-input_scan_list=
        |       | +-GraphNodeScan
        |       | | +-column_list=[$element_table.$element1#1]
        |       | | +-label_expr=
        |       | | | +-GraphLabel(parse_location=45-52, label=aml.Account)
        |       | | +-target_element_table_list=[aml.Account]
        |       | +-GraphEdgeScan
        |       | | +-column_list=[$element_table.$element2#2]
        |       | | +-label_expr=
        |       | | | +-GraphLabelNaryExpr
        |       | | |   +-op=OR
        |       | | |   +-operand_list=
        |       | | |     +-GraphWildCardLabel
        |       | | |     +-GraphLabelNaryExpr
        |       | | |       +-op=NOT
        |       | | |       +-operand_list=
        |       | | |         +-GraphWildCardLabel
        |       | | +-target_element_table_list=[aml.PersonOwnAccount,aml.Transfer]
        |       | | +-orientation=LEFT
        |       | +-GraphNodeScan
        |       |   +-column_list=[$element_table.$element3#3]
        |       |   +-label_expr=
        |       |   | +-GraphLabel(parse_location=61-68, label=aml.Account)
        |       |   +-target_element_table_list=[aml.Account]
        |       +-head=$element_table.$element1#1
        |       +-tail=$element_table.$element3#3
        +-shape_expr_list=
          +-one#4 := Literal(type=INT64, value=1)

[SQLBUILDER_TARGET_SYNTAX_MODE standard]
[SQLBUILDER_OUTPUT]
SELECT
  aml_1.a_5 AS one
FROM
  GRAPH_TABLE(
    aml
    MATCH
      (a_2
      IS Account)
      <-[a_3
      IS (% | ! %)]-
      (a_4
      IS Account)
    COLUMNS(
      1 AS a_5
    )
  ) AS aml_1;

[SQLBUILDER_TARGET_SYNTAX_MODE pipe]
[SQLBUILDER_OUTPUT]
FROM
  GRAPH_TABLE(
    aml
    MATCH
      (a_2
      IS Account)
      <-[a_3
      IS (% | ! %)]-
      (a_4
      IS Account)
    COLUMNS(
      1 AS a_5
    )
  ) AS aml_1
|> SELECT
     aml_1.a_5 AS one;
--
ALTERNATION GROUP: -
--
QueryStmt
+-output_column_list=
| +-$graph_table.one#4 AS one [INT64]
+-query=
  +-ProjectScan
    +-column_list=[$graph_table.one#4]
    +-input_scan=
      +-GraphTableScan
        +-column_list=[$graph_table.one#4]
        +-property_graph=aml
        +-input_scan=
        | +-GraphScan
        |   +-column_list=$element_table.[$element1#1, $element2#2, $element3#3]
        |   +-input_scan_list=
        |     +-GraphPathScan
        |       +-column_list=$element_table.[$element1#1, $element2#2, $element3#3]
        |       +-input_scan_list=
        |       | +-GraphNodeScan
        |       | | +-column_list=[$element_table.$element1#1]
        |       | | +-label_expr=
        |       | | | +-GraphLabel(parse_location=45-52, label=aml.Account)
        |       | | +-target_element_table_list=[aml.Account]
        |       | +-GraphEdgeScan
        |       | | +-column_list=[$element_table.$element2#2]
        |       | | +-label_expr=
        |       | | | +-GraphLabelNaryExpr
        |       | | |   +-op=OR
        |       | | |   +-operand_list=
        |       | | |     +-GraphWildCardLabel
        |       | | |     +-GraphLabelNaryExpr
        |       | | |       +-op=NOT
        |       | | |       +-operand_list=
        |       | | |         +-GraphWildCardLabel
        |       | | +-target_element_table_list=[aml.PersonOwnAccount,aml.Transfer]
        |       | | +-orientation=ANY
        |       | +-GraphNodeScan
        |       |   +-column_list=[$element_table.$element3#3]
        |       |   +-label_expr=
        |       |   | +-GraphLabel(parse_location=60-67, label=aml.Account)
        |       |   +-target_element_table_list=[aml.Account]
        |       +-head=$element_table.$element1#1
        |       +-tail=$element_table.$element3#3
        +-shape_expr_list=
          +-one#4 := Literal(type=INT64, value=1)

[SQLBUILDER_TARGET_SYNTAX_MODE standard]
[SQLBUILDER_OUTPUT]
SELECT
  aml_1.a_5 AS one
FROM
  GRAPH_TABLE(
    aml
    MATCH
      (a_2
      IS Account)
      -[a_3
      IS (% | ! %)]-
      (a_4
      IS Account)
    COLUMNS(
      1 AS a_5
    )
  ) AS aml_1;

[SQLBUILDER_TARGET_SYNTAX_MODE pipe]
[SQLBUILDER_OUTPUT]
FROM
  GRAPH_TABLE(
    aml
    MATCH
      (a_2
      IS Account)
      -[a_3
      IS (% | ! %)]-
      (a_4
      IS Account)
    COLUMNS(
      1 AS a_5
    )
  ) AS aml_1
|> SELECT
     aml_1.a_5 AS one;
--
ALTERNATION GROUP: ->
--
QueryStmt
+-output_column_list=
| +-$graph_table.one#4 AS one [INT64]
+-query=
  +-ProjectScan
    +-column_list=[$graph_table.one#4]
    +-input_scan=
      +-GraphTableScan
        +-column_list=[$graph_table.one#4]
        +-property_graph=aml
        +-input_scan=
        | +-GraphScan
        |   +-column_list=$element_table.[$element1#1, $element2#2, $element3#3]
        |   +-input_scan_list=
        |     +-GraphPathScan
        |       +-column_list=$element_table.[$element1#1, $element2#2, $element3#3]
        |       +-input_scan_list=
        |       | +-GraphNodeScan
        |       | | +-column_list=[$element_table.$element1#1]
        |       | | +-label_expr=
        |       | | | +-GraphLabel(parse_location=45-52, label=aml.Account)
        |       | | +-target_element_table_list=[aml.Account]
        |       | +-GraphEdgeScan
        |       | | +-column_list=[$element_table.$element2#2]
        |       | | +-label_expr=
        |       | | | +-GraphLabelNaryExpr
        |       | | |   +-op=OR
        |       | | |   +-operand_list=
        |       | | |     +-GraphWildCardLabel
        |       | | |     +-GraphLabelNaryExpr
        |       | | |       +-op=NOT
        |       | | |       +-operand_list=
        |       | | |         +-GraphWildCardLabel
        |       | | +-target_element_table_list=[aml.PersonOwnAccount,aml.Transfer]
        |       | | +-orientation=RIGHT
        |       | +-GraphNodeScan
        |       |   +-column_list=[$element_table.$element3#3]
        |       |   +-label_expr=
        |       |   | +-GraphLabel(parse_location=61-68, label=aml.Account)
        |       |   +-target_element_table_list=[aml.Account]
        |       +-head=$element_table.$element1#1
        |       +-tail=$element_table.$element3#3
        +-shape_expr_list=
          +-one#4 := Literal(type=INT64, value=1)

[SQLBUILDER_TARGET_SYNTAX_MODE standard]
[SQLBUILDER_OUTPUT]
SELECT
  aml_1.a_5 AS one
FROM
  GRAPH_TABLE(
    aml
    MATCH
      (a_2
      IS Account)
      -[a_3
      IS (% | ! %)]->
      (a_4
      IS Account)
    COLUMNS(
      1 AS a_5
    )
  ) AS aml_1;

[SQLBUILDER_TARGET_SYNTAX_MODE pipe]
[SQLBUILDER_OUTPUT]
FROM
  GRAPH_TABLE(
    aml
    MATCH
      (a_2
      IS Account)
      -[a_3
      IS (% | ! %)]->
      (a_4
      IS Account)
    COLUMNS(
      1 AS a_5
    )
  ) AS aml_1
|> SELECT
     aml_1.a_5 AS one;
==

# No match regardless of orientation: no edges between Person and Person.
select * from graph_table(
  aml
  match (IS Person) {{<-|-|->}} (IS Person)
  columns (1 as one)
)

--
ALTERNATION GROUP: <-
--
QueryStmt
+-output_column_list=
| +-$graph_table.one#4 AS one [INT64]
+-query=
  +-ProjectScan
    +-column_list=[$graph_table.one#4]
    +-input_scan=
      +-GraphTableScan
        +-column_list=[$graph_table.one#4]
        +-property_graph=aml
        +-input_scan=
        | +-GraphScan
        |   +-column_list=$element_table.[$element1#1, $element2#2, $element3#3]
        |   +-input_scan_list=
        |     +-GraphPathScan
        |       +-column_list=$element_table.[$element1#1, $element2#2, $element3#3]
        |       +-input_scan_list=
        |       | +-GraphNodeScan
        |       | | +-column_list=[$element_table.$element1#1]
        |       | | +-label_expr=
        |       | | | +-GraphLabel(parse_location=45-51, label=aml.Person)
        |       | | +-target_element_table_list=[aml.Person]
        |       | +-GraphEdgeScan
        |       | | +-column_list=[$element_table.$element2#2]
        |       | | +-label_expr=
        |       | | | +-GraphLabelNaryExpr
        |       | | |   +-op=OR
        |       | | |   +-operand_list=
        |       | | |     +-GraphWildCardLabel
        |       | | |     +-GraphLabelNaryExpr
        |       | | |       +-op=NOT
        |       | | |       +-operand_list=
        |       | | |         +-GraphWildCardLabel
        |       | | +-target_element_table_list=[aml.PersonOwnAccount,aml.Transfer]
        |       | | +-orientation=LEFT
        |       | +-GraphNodeScan
        |       |   +-column_list=[$element_table.$element3#3]
        |       |   +-label_expr=
        |       |   | +-GraphLabel(parse_location=60-66, label=aml.Person)
        |       |   +-target_element_table_list=[aml.Person]
        |       +-head=$element_table.$element1#1
        |       +-tail=$element_table.$element3#3
        +-shape_expr_list=
          +-one#4 := Literal(type=INT64, value=1)

[SQLBUILDER_TARGET_SYNTAX_MODE standard]
[SQLBUILDER_OUTPUT]
SELECT
  aml_1.a_5 AS one
FROM
  GRAPH_TABLE(
    aml
    MATCH
      (a_2
      IS Person)
      <-[a_3
      IS (% | ! %)]-
      (a_4
      IS Person)
    COLUMNS(
      1 AS a_5
    )
  ) AS aml_1;

[SQLBUILDER_TARGET_SYNTAX_MODE pipe]
[SQLBUILDER_OUTPUT]
FROM
  GRAPH_TABLE(
    aml
    MATCH
      (a_2
      IS Person)
      <-[a_3
      IS (% | ! %)]-
      (a_4
      IS Person)
    COLUMNS(
      1 AS a_5
    )
  ) AS aml_1
|> SELECT
     aml_1.a_5 AS one;
--
ALTERNATION GROUP: -
--
QueryStmt
+-output_column_list=
| +-$graph_table.one#4 AS one [INT64]
+-query=
  +-ProjectScan
    +-column_list=[$graph_table.one#4]
    +-input_scan=
      +-GraphTableScan
        +-column_list=[$graph_table.one#4]
        +-property_graph=aml
        +-input_scan=
        | +-GraphScan
        |   +-column_list=$element_table.[$element1#1, $element2#2, $element3#3]
        |   +-input_scan_list=
        |     +-GraphPathScan
        |       +-column_list=$element_table.[$element1#1, $element2#2, $element3#3]
        |       +-input_scan_list=
        |       | +-GraphNodeScan
        |       | | +-column_list=[$element_table.$element1#1]
        |       | | +-label_expr=
        |       | | | +-GraphLabel(parse_location=45-51, label=aml.Person)
        |       | | +-target_element_table_list=[aml.Person]
        |       | +-GraphEdgeScan
        |       | | +-column_list=[$element_table.$element2#2]
        |       | | +-label_expr=
        |       | | | +-GraphLabelNaryExpr
        |       | | |   +-op=OR
        |       | | |   +-operand_list=
        |       | | |     +-GraphWildCardLabel
        |       | | |     +-GraphLabelNaryExpr
        |       | | |       +-op=NOT
        |       | | |       +-operand_list=
        |       | | |         +-GraphWildCardLabel
        |       | | +-target_element_table_list=[aml.PersonOwnAccount,aml.Transfer]
        |       | | +-orientation=ANY
        |       | +-GraphNodeScan
        |       |   +-column_list=[$element_table.$element3#3]
        |       |   +-label_expr=
        |       |   | +-GraphLabel(parse_location=59-65, label=aml.Person)
        |       |   +-target_element_table_list=[aml.Person]
        |       +-head=$element_table.$element1#1
        |       +-tail=$element_table.$element3#3
        +-shape_expr_list=
          +-one#4 := Literal(type=INT64, value=1)

[SQLBUILDER_TARGET_SYNTAX_MODE standard]
[SQLBUILDER_OUTPUT]
SELECT
  aml_1.a_5 AS one
FROM
  GRAPH_TABLE(
    aml
    MATCH
      (a_2
      IS Person)
      -[a_3
      IS (% | ! %)]-
      (a_4
      IS Person)
    COLUMNS(
      1 AS a_5
    )
  ) AS aml_1;

[SQLBUILDER_TARGET_SYNTAX_MODE pipe]
[SQLBUILDER_OUTPUT]
FROM
  GRAPH_TABLE(
    aml
    MATCH
      (a_2
      IS Person)
      -[a_3
      IS (% | ! %)]-
      (a_4
      IS Person)
    COLUMNS(
      1 AS a_5
    )
  ) AS aml_1
|> SELECT
     aml_1.a_5 AS one;
--
ALTERNATION GROUP: ->
--
QueryStmt
+-output_column_list=
| +-$graph_table.one#4 AS one [INT64]
+-query=
  +-ProjectScan
    +-column_list=[$graph_table.one#4]
    +-input_scan=
      +-GraphTableScan
        +-column_list=[$graph_table.one#4]
        +-property_graph=aml
        +-input_scan=
        | +-GraphScan
        |   +-column_list=$element_table.[$element1#1, $element2#2, $element3#3]
        |   +-input_scan_list=
        |     +-GraphPathScan
        |       +-column_list=$element_table.[$element1#1, $element2#2, $element3#3]
        |       +-input_scan_list=
        |       | +-GraphNodeScan
        |       | | +-column_list=[$element_table.$element1#1]
        |       | | +-label_expr=
        |       | | | +-GraphLabel(parse_location=45-51, label=aml.Person)
        |       | | +-target_element_table_list=[aml.Person]
        |       | +-GraphEdgeScan
        |       | | +-column_list=[$element_table.$element2#2]
        |       | | +-label_expr=
        |       | | | +-GraphLabelNaryExpr
        |       | | |   +-op=OR
        |       | | |   +-operand_list=
        |       | | |     +-GraphWildCardLabel
        |       | | |     +-GraphLabelNaryExpr
        |       | | |       +-op=NOT
        |       | | |       +-operand_list=
        |       | | |         +-GraphWildCardLabel
        |       | | +-target_element_table_list=[aml.PersonOwnAccount,aml.Transfer]
        |       | | +-orientation=RIGHT
        |       | +-GraphNodeScan
        |       |   +-column_list=[$element_table.$element3#3]
        |       |   +-label_expr=
        |       |   | +-GraphLabel(parse_location=60-66, label=aml.Person)
        |       |   +-target_element_table_list=[aml.Person]
        |       +-head=$element_table.$element1#1
        |       +-tail=$element_table.$element3#3
        +-shape_expr_list=
          +-one#4 := Literal(type=INT64, value=1)

[SQLBUILDER_TARGET_SYNTAX_MODE standard]
[SQLBUILDER_OUTPUT]
SELECT
  aml_1.a_5 AS one
FROM
  GRAPH_TABLE(
    aml
    MATCH
      (a_2
      IS Person)
      -[a_3
      IS (% | ! %)]->
      (a_4
      IS Person)
    COLUMNS(
      1 AS a_5
    )
  ) AS aml_1;

[SQLBUILDER_TARGET_SYNTAX_MODE pipe]
[SQLBUILDER_OUTPUT]
FROM
  GRAPH_TABLE(
    aml
    MATCH
      (a_2
      IS Person)
      -[a_3
      IS (% | ! %)]->
      (a_4
      IS Person)
    COLUMNS(
      1 AS a_5
    )
  ) AS aml_1
|> SELECT
     aml_1.a_5 AS one;
==

# No match regardless of orientation: wrong edges between Person and Account.
select * from graph_table(
  aml
  match (a IS Person) {{<-[IS Transfer]-|-[IS Transfer]-|-[IS Transfer]->}} (b IS Account)
  columns (1 as one)
)
--
ALTERNATION GROUP: <-[IS Transfer]-
--
QueryStmt
+-output_column_list=
| +-$graph_table.one#4 AS one [INT64]
+-query=
  +-ProjectScan
    +-column_list=[$graph_table.one#4]
    +-input_scan=
      +-GraphTableScan
        +-column_list=[$graph_table.one#4]
        +-property_graph=aml
        +-input_scan=
        | +-GraphScan
        |   +-column_list=$element_table.[a#1, $element1#2, b#3]
        |   +-input_scan_list=
        |     +-GraphPathScan
        |       +-column_list=$element_table.[a#1, $element1#2, b#3]
        |       +-input_scan_list=
        |       | +-GraphNodeScan
        |       | | +-column_list=[$element_table.a#1]
        |       | | +-label_expr=
        |       | | | +-GraphLabel(parse_location=47-53, label=aml.Person)
        |       | | +-target_element_table_list=[aml.Person]
        |       | +-GraphEdgeScan
        |       | | +-column_list=[$element_table.$element1#2]
        |       | | +-label_expr=
        |       | | | +-GraphLabel(parse_location=61-69, label=aml.Transfer)
        |       | | +-target_element_table_list=[aml.Transfer]
        |       | | +-orientation=LEFT
        |       | +-GraphNodeScan
        |       |   +-column_list=[$element_table.b#3]
        |       |   +-label_expr=
        |       |   | +-GraphLabel(parse_location=78-85, label=aml.Account)
        |       |   +-target_element_table_list=[aml.Account]
        |       +-head=$element_table.a#1
        |       +-tail=$element_table.b#3
        +-shape_expr_list=
          +-one#4 := Literal(type=INT64, value=1)

[SQLBUILDER_TARGET_SYNTAX_MODE standard]
[SQLBUILDER_OUTPUT]
SELECT
  aml_1.a_5 AS one
FROM
  GRAPH_TABLE(
    aml
    MATCH
      (a_2
      IS Person)
      <-[a_3
      IS Transfer]-
      (a_4
      IS Account)
    COLUMNS(
      1 AS a_5
    )
  ) AS aml_1;

[SQLBUILDER_TARGET_SYNTAX_MODE pipe]
[SQLBUILDER_OUTPUT]
FROM
  GRAPH_TABLE(
    aml
    MATCH
      (a_2
      IS Person)
      <-[a_3
      IS Transfer]-
      (a_4
      IS Account)
    COLUMNS(
      1 AS a_5
    )
  ) AS aml_1
|> SELECT
     aml_1.a_5 AS one;
--
ALTERNATION GROUP: -[IS Transfer]-
--
QueryStmt
+-output_column_list=
| +-$graph_table.one#4 AS one [INT64]
+-query=
  +-ProjectScan
    +-column_list=[$graph_table.one#4]
    +-input_scan=
      +-GraphTableScan
        +-column_list=[$graph_table.one#4]
        +-property_graph=aml
        +-input_scan=
        | +-GraphScan
        |   +-column_list=$element_table.[a#1, $element1#2, b#3]
        |   +-input_scan_list=
        |     +-GraphPathScan
        |       +-column_list=$element_table.[a#1, $element1#2, b#3]
        |       +-input_scan_list=
        |       | +-GraphNodeScan
        |       | | +-column_list=[$element_table.a#1]
        |       | | +-label_expr=
        |       | | | +-GraphLabel(parse_location=47-53, label=aml.Person)
        |       | | +-target_element_table_list=[aml.Person]
        |       | +-GraphEdgeScan
        |       | | +-column_list=[$element_table.$element1#2]
        |       | | +-label_expr=
        |       | | | +-GraphLabel(parse_location=60-68, label=aml.Transfer)
        |       | | +-target_element_table_list=[aml.Transfer]
        |       | | +-orientation=ANY
        |       | +-GraphNodeScan
        |       |   +-column_list=[$element_table.b#3]
        |       |   +-label_expr=
        |       |   | +-GraphLabel(parse_location=77-84, label=aml.Account)
        |       |   +-target_element_table_list=[aml.Account]
        |       +-head=$element_table.a#1
        |       +-tail=$element_table.b#3
        +-shape_expr_list=
          +-one#4 := Literal(type=INT64, value=1)

[SQLBUILDER_TARGET_SYNTAX_MODE standard]
[SQLBUILDER_OUTPUT]
SELECT
  aml_1.a_5 AS one
FROM
  GRAPH_TABLE(
    aml
    MATCH
      (a_2
      IS Person)
      -[a_3
      IS Transfer]-
      (a_4
      IS Account)
    COLUMNS(
      1 AS a_5
    )
  ) AS aml_1;

[SQLBUILDER_TARGET_SYNTAX_MODE pipe]
[SQLBUILDER_OUTPUT]
FROM
  GRAPH_TABLE(
    aml
    MATCH
      (a_2
      IS Person)
      -[a_3
      IS Transfer]-
      (a_4
      IS Account)
    COLUMNS(
      1 AS a_5
    )
  ) AS aml_1
|> SELECT
     aml_1.a_5 AS one;
--
ALTERNATION GROUP: -[IS Transfer]->
--
QueryStmt
+-output_column_list=
| +-$graph_table.one#4 AS one [INT64]
+-query=
  +-ProjectScan
    +-column_list=[$graph_table.one#4]
    +-input_scan=
      +-GraphTableScan
        +-column_list=[$graph_table.one#4]
        +-property_graph=aml
        +-input_scan=
        | +-GraphScan
        |   +-column_list=$element_table.[a#1, $element1#2, b#3]
        |   +-input_scan_list=
        |     +-GraphPathScan
        |       +-column_list=$element_table.[a#1, $element1#2, b#3]
        |       +-input_scan_list=
        |       | +-GraphNodeScan
        |       | | +-column_list=[$element_table.a#1]
        |       | | +-label_expr=
        |       | | | +-GraphLabel(parse_location=47-53, label=aml.Person)
        |       | | +-target_element_table_list=[aml.Person]
        |       | +-GraphEdgeScan
        |       | | +-column_list=[$element_table.$element1#2]
        |       | | +-label_expr=
        |       | | | +-GraphLabel(parse_location=60-68, label=aml.Transfer)
        |       | | +-target_element_table_list=[aml.Transfer]
        |       | | +-orientation=RIGHT
        |       | +-GraphNodeScan
        |       |   +-column_list=[$element_table.b#3]
        |       |   +-label_expr=
        |       |   | +-GraphLabel(parse_location=78-85, label=aml.Account)
        |       |   +-target_element_table_list=[aml.Account]
        |       +-head=$element_table.a#1
        |       +-tail=$element_table.b#3
        +-shape_expr_list=
          +-one#4 := Literal(type=INT64, value=1)

[SQLBUILDER_TARGET_SYNTAX_MODE standard]
[SQLBUILDER_OUTPUT]
SELECT
  aml_1.a_5 AS one
FROM
  GRAPH_TABLE(
    aml
    MATCH
      (a_2
      IS Person)
      -[a_3
      IS Transfer]->
      (a_4
      IS Account)
    COLUMNS(
      1 AS a_5
    )
  ) AS aml_1;

[SQLBUILDER_TARGET_SYNTAX_MODE pipe]
[SQLBUILDER_OUTPUT]
FROM
  GRAPH_TABLE(
    aml
    MATCH
      (a_2
      IS Person)
      -[a_3
      IS Transfer]->
      (a_4
      IS Account)
    COLUMNS(
      1 AS a_5
    )
  ) AS aml_1
|> SELECT
     aml_1.a_5 AS one;
==

# Matches Person, PersonOwnAccount, Account AND
#         Account, Transfer, Account
# when orientation is RIGHT or ANY;
#
# Matches Account, Transfer, Account
# when orientation is LEFT.
select * from graph_table(
  aml
  match (a IS Person | Account) {{<-|-|->}} (b IS Account)
  columns (1 as one)
)
--
ALTERNATION GROUP: <-
--
QueryStmt
+-output_column_list=
| +-$graph_table.one#4 AS one [INT64]
+-query=
  +-ProjectScan
    +-column_list=[$graph_table.one#4]
    +-input_scan=
      +-GraphTableScan
        +-column_list=[$graph_table.one#4]
        +-property_graph=aml
        +-input_scan=
        | +-GraphScan
        |   +-column_list=$element_table.[a#1, $element1#2, b#3]
        |   +-input_scan_list=
        |     +-GraphPathScan
        |       +-column_list=$element_table.[a#1, $element1#2, b#3]
        |       +-input_scan_list=
        |       | +-GraphNodeScan
        |       | | +-column_list=[$element_table.a#1]
        |       | | +-label_expr=
        |       | | | +-GraphLabelNaryExpr
        |       | | |   +-parse_location=47-63
        |       | | |   +-op=OR
        |       | | |   +-operand_list=
        |       | | |     +-GraphLabel(parse_location=47-53, label=aml.Person)
        |       | | |     +-GraphLabel(parse_location=56-63, label=aml.Account)
        |       | | +-target_element_table_list=[aml.Account,aml.Person]
        |       | +-GraphEdgeScan
        |       | | +-column_list=[$element_table.$element1#2]
        |       | | +-label_expr=
        |       | | | +-GraphLabelNaryExpr
        |       | | |   +-op=OR
        |       | | |   +-operand_list=
        |       | | |     +-GraphWildCardLabel
        |       | | |     +-GraphLabelNaryExpr
        |       | | |       +-op=NOT
        |       | | |       +-operand_list=
        |       | | |         +-GraphWildCardLabel
        |       | | +-target_element_table_list=[aml.PersonOwnAccount,aml.Transfer]
        |       | | +-orientation=LEFT
        |       | +-GraphNodeScan
        |       |   +-column_list=[$element_table.b#3]
        |       |   +-label_expr=
        |       |   | +-GraphLabel(parse_location=74-81, label=aml.Account)
        |       |   +-target_element_table_list=[aml.Account]
        |       +-head=$element_table.a#1
        |       +-tail=$element_table.b#3
        +-shape_expr_list=
          +-one#4 := Literal(type=INT64, value=1)

[SQLBUILDER_TARGET_SYNTAX_MODE standard]
[SQLBUILDER_OUTPUT]
SELECT
  aml_1.a_5 AS one
FROM
  GRAPH_TABLE(
    aml
    MATCH
      (a_2
      IS (Person | Account))
      <-[a_3
      IS (% | ! %)]-
      (a_4
      IS Account)
    COLUMNS(
      1 AS a_5
    )
  ) AS aml_1;

[SQLBUILDER_TARGET_SYNTAX_MODE pipe]
[SQLBUILDER_OUTPUT]
FROM
  GRAPH_TABLE(
    aml
    MATCH
      (a_2
      IS (Person | Account))
      <-[a_3
      IS (% | ! %)]-
      (a_4
      IS Account)
    COLUMNS(
      1 AS a_5
    )
  ) AS aml_1
|> SELECT
     aml_1.a_5 AS one;
--
ALTERNATION GROUP: -
--
QueryStmt
+-output_column_list=
| +-$graph_table.one#4 AS one [INT64]
+-query=
  +-ProjectScan
    +-column_list=[$graph_table.one#4]
    +-input_scan=
      +-GraphTableScan
        +-column_list=[$graph_table.one#4]
        +-property_graph=aml
        +-input_scan=
        | +-GraphScan
        |   +-column_list=$element_table.[a#1, $element1#2, b#3]
        |   +-input_scan_list=
        |     +-GraphPathScan
        |       +-column_list=$element_table.[a#1, $element1#2, b#3]
        |       +-input_scan_list=
        |       | +-GraphNodeScan
        |       | | +-column_list=[$element_table.a#1]
        |       | | +-label_expr=
        |       | | | +-GraphLabelNaryExpr
        |       | | |   +-parse_location=47-63
        |       | | |   +-op=OR
        |       | | |   +-operand_list=
        |       | | |     +-GraphLabel(parse_location=47-53, label=aml.Person)
        |       | | |     +-GraphLabel(parse_location=56-63, label=aml.Account)
        |       | | +-target_element_table_list=[aml.Account,aml.Person]
        |       | +-GraphEdgeScan
        |       | | +-column_list=[$element_table.$element1#2]
        |       | | +-label_expr=
        |       | | | +-GraphLabelNaryExpr
        |       | | |   +-op=OR
        |       | | |   +-operand_list=
        |       | | |     +-GraphWildCardLabel
        |       | | |     +-GraphLabelNaryExpr
        |       | | |       +-op=NOT
        |       | | |       +-operand_list=
        |       | | |         +-GraphWildCardLabel
        |       | | +-target_element_table_list=[aml.PersonOwnAccount,aml.Transfer]
        |       | | +-orientation=ANY
        |       | +-GraphNodeScan
        |       |   +-column_list=[$element_table.b#3]
        |       |   +-label_expr=
        |       |   | +-GraphLabel(parse_location=73-80, label=aml.Account)
        |       |   +-target_element_table_list=[aml.Account]
        |       +-head=$element_table.a#1
        |       +-tail=$element_table.b#3
        +-shape_expr_list=
          +-one#4 := Literal(type=INT64, value=1)

[SQLBUILDER_TARGET_SYNTAX_MODE standard]
[SQLBUILDER_OUTPUT]
SELECT
  aml_1.a_5 AS one
FROM
  GRAPH_TABLE(
    aml
    MATCH
      (a_2
      IS (Person | Account))
      -[a_3
      IS (% | ! %)]-
      (a_4
      IS Account)
    COLUMNS(
      1 AS a_5
    )
  ) AS aml_1;

[SQLBUILDER_TARGET_SYNTAX_MODE pipe]
[SQLBUILDER_OUTPUT]
FROM
  GRAPH_TABLE(
    aml
    MATCH
      (a_2
      IS (Person | Account))
      -[a_3
      IS (% | ! %)]-
      (a_4
      IS Account)
    COLUMNS(
      1 AS a_5
    )
  ) AS aml_1
|> SELECT
     aml_1.a_5 AS one;
--
ALTERNATION GROUP: ->
--
QueryStmt
+-output_column_list=
| +-$graph_table.one#4 AS one [INT64]
+-query=
  +-ProjectScan
    +-column_list=[$graph_table.one#4]
    +-input_scan=
      +-GraphTableScan
        +-column_list=[$graph_table.one#4]
        +-property_graph=aml
        +-input_scan=
        | +-GraphScan
        |   +-column_list=$element_table.[a#1, $element1#2, b#3]
        |   +-input_scan_list=
        |     +-GraphPathScan
        |       +-column_list=$element_table.[a#1, $element1#2, b#3]
        |       +-input_scan_list=
        |       | +-GraphNodeScan
        |       | | +-column_list=[$element_table.a#1]
        |       | | +-label_expr=
        |       | | | +-GraphLabelNaryExpr
        |       | | |   +-parse_location=47-63
        |       | | |   +-op=OR
        |       | | |   +-operand_list=
        |       | | |     +-GraphLabel(parse_location=47-53, label=aml.Person)
        |       | | |     +-GraphLabel(parse_location=56-63, label=aml.Account)
        |       | | +-target_element_table_list=[aml.Account,aml.Person]
        |       | +-GraphEdgeScan
        |       | | +-column_list=[$element_table.$element1#2]
        |       | | +-label_expr=
        |       | | | +-GraphLabelNaryExpr
        |       | | |   +-op=OR
        |       | | |   +-operand_list=
        |       | | |     +-GraphWildCardLabel
        |       | | |     +-GraphLabelNaryExpr
        |       | | |       +-op=NOT
        |       | | |       +-operand_list=
        |       | | |         +-GraphWildCardLabel
        |       | | +-target_element_table_list=[aml.PersonOwnAccount,aml.Transfer]
        |       | | +-orientation=RIGHT
        |       | +-GraphNodeScan
        |       |   +-column_list=[$element_table.b#3]
        |       |   +-label_expr=
        |       |   | +-GraphLabel(parse_location=74-81, label=aml.Account)
        |       |   +-target_element_table_list=[aml.Account]
        |       +-head=$element_table.a#1
        |       +-tail=$element_table.b#3
        +-shape_expr_list=
          +-one#4 := Literal(type=INT64, value=1)

[SQLBUILDER_TARGET_SYNTAX_MODE standard]
[SQLBUILDER_OUTPUT]
SELECT
  aml_1.a_5 AS one
FROM
  GRAPH_TABLE(
    aml
    MATCH
      (a_2
      IS (Person | Account))
      -[a_3
      IS (% | ! %)]->
      (a_4
      IS Account)
    COLUMNS(
      1 AS a_5
    )
  ) AS aml_1;

[SQLBUILDER_TARGET_SYNTAX_MODE pipe]
[SQLBUILDER_OUTPUT]
FROM
  GRAPH_TABLE(
    aml
    MATCH
      (a_2
      IS (Person | Account))
      -[a_3
      IS (% | ! %)]->
      (a_4
      IS Account)
    COLUMNS(
      1 AS a_5
    )
  ) AS aml_1
|> SELECT
     aml_1.a_5 AS one;
